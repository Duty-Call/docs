"use strict";(self.webpackChunkdocs_dutycall=self.webpackChunkdocs_dutycall||[]).push([[1145],{1470:(e,n,r)=>{r.d(n,{A:()=>S});var l=r(6540),s=r(4164),i=r(7559),t=r(3104),a=r(6347),c=r(205),d=r(7485),o=r(1682),h=r(679);function p(e){var n,r;return null!=(n=null==(r=l.Children.toArray(e).filter(function(e){return"\n"!==e}).map(function(e){if(!e||(0,l.isValidElement)(e)&&((n=e.props)&&"object"==typeof n&&"value"in n))return e;var n;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')}))?void 0:r.filter(Boolean))?n:[]}function u(e){var n=e.values,r=e.children;return(0,l.useMemo)(function(){var e=null!=n?n:function(e){return p(e).map(function(e){var n=e.props;return{value:n.value,label:n.label,attributes:n.attributes,default:n.default}})}(r);return function(e){var n=(0,o.XI)(e,function(e,n){return e.value===n.value});if(n.length>0)throw new Error('Docusaurus error: Duplicate values "'+n.map(function(e){return e.value}).join(", ")+'" found in <Tabs>. Every value needs to be unique.')}(e),e},[n,r])}function x(e){var n=e.value;return e.tabValues.some(function(e){return e.value===n})}function j(e){var n=e.queryString,r=void 0!==n&&n,s=e.groupId,i=(0,a.W6)(),t=function(e){var n=e.queryString,r=void 0!==n&&n,l=e.groupId;if("string"==typeof r)return r;if(!1===r)return null;if(!0===r&&!l)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=l?l:null}({queryString:r,groupId:s});return[(0,d.aZ)(t),(0,l.useCallback)(function(e){if(t){var n=new URLSearchParams(i.location.search);n.set(t,e),i.replace(Object.assign({},i.location,{search:n.toString()}))}},[t,i])]}function g(e){var n,r,s,i,t=e.defaultValue,a=e.queryString,d=void 0!==a&&a,o=e.groupId,p=u(e),g=(0,l.useState)(function(){return function(e){var n,r=e.defaultValue,l=e.tabValues;if(0===l.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(r){if(!x({value:r,tabValues:l}))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+r+'" but none of its children has the corresponding value. Available values are: '+l.map(function(e){return e.value}).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");return r}var s=null!=(n=l.find(function(e){return e.default}))?n:l[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:t,tabValues:p})}),m=g[0],v=g[1],y=j({queryString:d,groupId:o}),b=y[0],f=y[1],w=(n=function(e){return e?"docusaurus.tab."+e:null}({groupId:o}.groupId),r=(0,h.Dv)(n),s=r[0],i=r[1],[s,(0,l.useCallback)(function(e){n&&i.set(e)},[n,i])]),S=w[0],R=w[1],k=function(){var e=null!=b?b:S;return x({value:e,tabValues:p})?e:null}();return(0,c.A)(function(){k&&v(k)},[k]),{selectedValue:m,selectValue:(0,l.useCallback)(function(e){if(!x({value:e,tabValues:p}))throw new Error("Can't select invalid tab value="+e);v(e),f(e),R(e)},[f,R,p]),tabValues:p}}var m=r(2303);const v={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var y=r(4848);function b(e){var n=e.className,r=e.block,l=e.selectedValue,i=e.selectValue,a=e.tabValues,c=[],d=(0,t.a_)().blockElementScrollPositionUntilNextRender,o=function(e){var n=e.currentTarget,r=c.indexOf(n),s=a[r].value;s!==l&&(d(n),i(s))},h=function(e){var n,r=null;switch(e.key){case"Enter":o(e);break;case"ArrowRight":var l,s=c.indexOf(e.currentTarget)+1;r=null!=(l=c[s])?l:c[0];break;case"ArrowLeft":var i,t=c.indexOf(e.currentTarget)-1;r=null!=(i=c[t])?i:c[c.length-1]}null==(n=r)||n.focus()};return(0,y.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":r},n),children:a.map(function(e){var n=e.value,r=e.label,i=e.attributes;return(0,y.jsx)("li",Object.assign({role:"tab",tabIndex:l===n?0:-1,"aria-selected":l===n,ref:function(e){c.push(e)},onKeyDown:h,onClick:o},i,{className:(0,s.A)("tabs__item",v.tabItem,null==i?void 0:i.className,{"tabs__item--active":l===n}),children:null!=r?r:n}),n)})})}function f(e){var n=e.lazy,r=e.children,i=e.selectedValue,t=(Array.isArray(r)?r:[r]).filter(Boolean);if(n){var a=t.find(function(e){return e.props.value===i});return a?(0,l.cloneElement)(a,{className:(0,s.A)("margin-top--md",a.props.className)}):null}return(0,y.jsx)("div",{className:"margin-top--md",children:t.map(function(e,n){return(0,l.cloneElement)(e,{key:n,hidden:e.props.value!==i})})})}function w(e){var n=g(e);return(0,y.jsxs)("div",{className:(0,s.A)(i.G.tabs.container,"tabs-container",v.tabList),children:[(0,y.jsx)(b,Object.assign({},n,e)),(0,y.jsx)(f,Object.assign({},n,e))]})}function S(e){var n=(0,m.A)();return(0,y.jsx)(w,Object.assign({},e,{children:p(e.children)}),String(n))}},6594:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>u,frontMatter:()=>c,metadata:()=>l,toc:()=>h});const l=JSON.parse('{"id":"developers/deployment/production","title":"Production Deployment Guide","description":"Last Updated: October 19, 2025","source":"@site/docs/developers/deployment/production.md","sourceDirName":"developers/deployment","slug":"/developers/deployment/production","permalink":"/developers/deployment/production","draft":false,"unlisted":false,"editUrl":"https://github.com/dutycall/docs/tree/main/docs/developers/deployment/production.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"docs","previous":{"title":"Monitoring Systems","permalink":"/monitoring"},"next":{"title":"Railway","permalink":"/developers/deployment/backend/railway"}}');var s=r(4848),i=r(8453),t=r(1470),a=r(9365);const c={sidebar_position:1},d="Production Deployment Guide",o={},h=[{value:"Overview",id:"overview",level:2},{value:"Deployment Platform Options",id:"deployment-platform-options",level:3},{value:"\u26a0\ufe0f Railway Warning - October 19, 2025 Incident",id:"\ufe0f-railway-warning---october-19-2025-incident",level:2},{value:"DigitalOcean Droplet Deployment (Recommended)",id:"digitalocean-droplet-deployment-recommended",level:2},{value:"Prerequisites",id:"prerequisites",level:3},{value:"Step 1: Create Droplet",id:"step-1-create-droplet",level:3},{value:"Step 2: Install LEMP Stack",id:"step-2-install-lemp-stack",level:3},{value:"Step 3: Configure MySQL Database",id:"step-3-configure-mysql-database",level:3},{value:"Step 4: Deploy Laravel Backend",id:"step-4-deploy-laravel-backend",level:3},{value:"Step 5: Configure Nginx",id:"step-5-configure-nginx",level:3},{value:"Step 6: Configure DNS &amp; SSL",id:"step-6-configure-dns--ssl",level:3},{value:"Step 7: Configure Firewall",id:"step-7-configure-firewall",level:3},{value:"Step 8: Test Backend",id:"step-8-test-backend",level:3},{value:"Railway Deployment (Alternative - Not Recommended for Production)",id:"railway-deployment-alternative---not-recommended-for-production",level:2},{value:"Step 1: Install Railway CLI",id:"step-1-install-railway-cli",level:3},{value:"Step 2: Configure Environment Variables",id:"step-2-configure-environment-variables",level:3},{value:"Step 3: Deploy",id:"step-3-deploy",level:3},{value:"Step 4: Run Migrations",id:"step-4-run-migrations",level:3},{value:"Vercel Frontend Deployment",id:"vercel-frontend-deployment",level:2},{value:"Step 1: Install Vercel CLI",id:"step-1-install-vercel-cli",level:3},{value:"Step 2: Link Project",id:"step-2-link-project",level:3},{value:"Step 3: Configure Environment Variables",id:"step-3-configure-environment-variables",level:3},{value:"Step 4: Deploy",id:"step-4-deploy",level:3},{value:"Step 5: Verify Deployment",id:"step-5-verify-deployment",level:3},{value:"CORS Configuration Best Practices",id:"cors-configuration-best-practices",level:2},{value:"The Problem",id:"the-problem",level:3},{value:"The Solution",id:"the-solution",level:3},{value:"After Updating CORS Config",id:"after-updating-cors-config",level:3},{value:"Test CORS",id:"test-cors",level:3},{value:"Monitoring &amp; Alerting (MANDATORY FOR PRODUCTION)",id:"monitoring--alerting-mandatory-for-production",level:2},{value:"UptimeRobot Setup (Free)",id:"uptimerobot-setup-free",level:3},{value:"1. Backend API Health",id:"1-backend-api-health",level:4},{value:"2. SSL Certificate Monitor",id:"2-ssl-certificate-monitor",level:4},{value:"3. Frontend Health",id:"3-frontend-health",level:4},{value:"Sentry Error Tracking (Recommended)",id:"sentry-error-tracking-recommended",level:3},{value:"Security Best Practices",id:"security-best-practices",level:2},{value:"Security Checklist",id:"security-checklist",level:3},{value:"Hardening SSH Access",id:"hardening-ssh-access",level:3},{value:"Automated Security Updates",id:"automated-security-updates",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Storage Permission Errors",id:"storage-permission-errors",level:3},{value:"CORS Errors",id:"cors-errors",level:3},{value:"Database Connection Errors",id:"database-connection-errors",level:3},{value:"Frontend - Old Deployment Cached",id:"frontend---old-deployment-cached",level:3},{value:"Frontend - Environment Variables Not Applied",id:"frontend---environment-variables-not-applied",level:3},{value:"Quick Diagnostic Commands",id:"quick-diagnostic-commands",level:3},{value:"Common Issues Quick Fix Matrix",id:"common-issues-quick-fix-matrix",level:3},{value:"Investigation Checklist",id:"investigation-checklist",level:3},{value:"Emergency Rollback",id:"emergency-rollback",level:3},{value:"Key Files Reference",id:"key-files-reference",level:3},{value:"Additional Resources",id:"additional-resources",level:2}];function p(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"production-deployment-guide",children:"Production Deployment Guide"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Last Updated:"})," October 19, 2025\n",(0,s.jsx)(n.strong,{children:"Status:"})," Production-tested and verified"]}),"\n",(0,s.jsx)(n.p,{children:"Deploy DutyCall backend and frontend with multiple hosting options."}),"\n","\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsxs)(t.A,{groupId:"developer-type",children:[(0,s.jsxs)(a.A,{value:"human",label:"\ud83d\udc68\u200d\ud83d\udcbb Human Developer",default:!0,children:[(0,s.jsx)(n.p,{children:"DutyCall consists of two main components:"}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Backend"}),": Laravel 11 API (PHP 8.3 + MySQL/PostgreSQL)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Frontend"}),": Next.js 15 SPA (React)"]}),"\n"]}),(0,s.jsx)(n.p,{children:"This guide covers multiple deployment options to ensure reliability, security, and maintainability for production environments."}),(0,s.jsx)(n.h3,{id:"deployment-platform-options",children:"Deployment Platform Options"}),(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Feature"}),(0,s.jsx)(n.th,{children:"DigitalOcean Droplet"}),(0,s.jsx)(n.th,{children:"Railway"}),(0,s.jsx)(n.th,{children:"Vercel (Frontend)"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Control"})}),(0,s.jsx)(n.td,{children:"Full root access"}),(0,s.jsx)(n.td,{children:"Managed platform"}),(0,s.jsx)(n.td,{children:"Managed platform"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Reliability"})}),(0,s.jsx)(n.td,{children:"You manage it"}),(0,s.jsx)(n.td,{children:"Platform-dependent"}),(0,s.jsx)(n.td,{children:"Excellent"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Cost"})}),(0,s.jsx)(n.td,{children:"$12/month (2GB)"}),(0,s.jsx)(n.td,{children:"Free tier available"}),(0,s.jsx)(n.td,{children:"Free tier available"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Env Var Stability"})}),(0,s.jsx)(n.td,{children:"\u2705 Stable"}),(0,s.jsx)(n.td,{children:"\u26a0\ufe0f Has failed in production"}),(0,s.jsx)(n.td,{children:"\u2705 Stable"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Monitoring"})}),(0,s.jsx)(n.td,{children:"You configure it"}),(0,s.jsx)(n.td,{children:"Built-in (basic)"}),(0,s.jsx)(n.td,{children:"Built-in (basic)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Recommended For"})}),(0,s.jsx)(n.td,{children:"Production backend"}),(0,s.jsx)(n.td,{children:"Development/staging"}),(0,s.jsx)(n.td,{children:"Production frontend"})]})]})]})]}),(0,s.jsxs)(a.A,{value:"ai",label:"\ud83e\udd16 AI Agent",children:[(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Architecture Stack"}),":"]}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Backend: Laravel 11 (PHP 8.3)"}),"\n",(0,s.jsx)(n.li,{children:"Frontend: Next.js 15 (React)"}),"\n",(0,s.jsx)(n.li,{children:"Database: MySQL (DigitalOcean) or PostgreSQL (Railway)"}),"\n",(0,s.jsx)(n.li,{children:"Deployment: Multi-platform support"}),"\n"]}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Platform Options"}),":"]}),(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"DigitalOcean Droplet"})," (Recommended for production)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Full control, stable, requires manual setup"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Railway"})," (Alternative, with warnings)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Managed, auto-deploy, known reliability issues"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Vercel"})," (Frontend only)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Edge deployment, excellent for Next.js"}),"\n"]}),"\n"]}),"\n"]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"\ufe0f-railway-warning---october-19-2025-incident",children:"\u26a0\ufe0f Railway Warning - October 19, 2025 Incident"}),"\n",(0,s.jsxs)(t.A,{groupId:"developer-type",children:[(0,s.jsxs)(a.A,{value:"human",label:"\ud83d\udc68\u200d\ud83d\udcbb Human Developer",default:!0,children:[(0,s.jsx)(n.admonition,{title:"Production Outage on Railway",type:"danger",children:(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Date:"})," October 19, 2025\n",(0,s.jsx)(n.strong,{children:"Impact:"})," Complete production outage - Login broken for all users\n",(0,s.jsx)(n.strong,{children:"Root Cause:"})," Railway ",(0,s.jsx)(n.code,{children:"FRONTEND_URL"})," environment variable disappeared without warning\n",(0,s.jsx)(n.strong,{children:"Duration:"})," 6+ hours (detection + migration to DigitalOcean)\n",(0,s.jsx)(n.strong,{children:"Lesson Learned:"})," ",(0,s.jsx)(n.strong,{children:"Do NOT rely on Railway for production without extensive monitoring"})]})}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"If you choose Railway for production, you MUST:"})}),(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Set up external monitoring (UptimeRobot - see ",(0,s.jsx)(n.a,{href:"#monitoring--alerting",children:"Monitoring section"}),")"]}),"\n",(0,s.jsx)(n.li,{children:"Document all environment variables externally"}),"\n",(0,s.jsx)(n.li,{children:"Configure manual database backups"}),"\n",(0,s.jsx)(n.li,{children:"Be prepared to migrate to another platform"}),"\n"]}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Recommended:"})," Use Railway for development/staging only. Use DigitalOcean Droplet for production."]})]}),(0,s.jsxs)(a.A,{value:"ai",label:"\ud83e\udd16 AI Agent",children:[(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Incident Report"}),":"]}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Event"}),": Railway env var ",(0,s.jsx)(n.code,{children:"FRONTEND_URL"})," disappeared"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Effect"}),": CORS failure, complete auth breakdown"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Recovery"}),": 6+ hour migration to DigitalOcean"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Conclusion"}),": Railway unreliable for production workloads"]}),"\n"]}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Railway Risk Factors"}),":"]}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Environment variables can disappear"}),"\n",(0,s.jsx)(n.li,{children:"No automatic backups on free tier"}),"\n",(0,s.jsx)(n.li,{children:"Limited infrastructure control"}),"\n",(0,s.jsx)(n.li,{children:"Platform-dependent reliability"}),"\n"]}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Mitigation if using Railway"}),":"]}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"External monitoring (mandatory)"}),"\n",(0,s.jsx)(n.li,{children:"External env var documentation"}),"\n",(0,s.jsx)(n.li,{children:"Manual backup schedule"}),"\n",(0,s.jsx)(n.li,{children:"Migration plan ready"}),"\n"]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"digitalocean-droplet-deployment-recommended",children:"DigitalOcean Droplet Deployment (Recommended)"}),"\n",(0,s.jsxs)(t.A,{groupId:"developer-type",children:[(0,s.jsxs)(a.A,{value:"human",label:"\ud83d\udc68\u200d\ud83d\udcbb Human Developer",default:!0,children:[(0,s.jsx)(n.h3,{id:"prerequisites",children:"Prerequisites"}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"DigitalOcean account"}),"\n",(0,s.jsx)(n.li,{children:"Domain name with DNS control"}),"\n",(0,s.jsx)(n.li,{children:"SSH key pair"}),"\n",(0,s.jsx)(n.li,{children:"GitHub repository access"}),"\n"]}),(0,s.jsx)(n.h3,{id:"step-1-create-droplet",children:"Step 1: Create Droplet"}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Via DigitalOcean Web UI:"})}),(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Login to DigitalOcean"}),"\n",(0,s.jsx)(n.li,{children:"Create \u2192 Droplets"}),"\n",(0,s.jsxs)(n.li,{children:["Choose plan: ",(0,s.jsx)(n.strong,{children:"Basic $12/month (2GB RAM, 1 vCPU, 50GB SSD)"})]}),"\n",(0,s.jsx)(n.li,{children:"Region: Select closest to your users"}),"\n",(0,s.jsxs)(n.li,{children:["OS: ",(0,s.jsx)(n.strong,{children:"Ubuntu 22.04 LTS"})]}),"\n",(0,s.jsx)(n.li,{children:"Authentication: Add your SSH key"}),"\n",(0,s.jsxs)(n.li,{children:["Hostname: ",(0,s.jsx)(n.code,{children:"dutycall-backend"})]}),"\n"]}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Via CLI (doctl):"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Install doctl\nbrew install doctl  # macOS\n\n# Authenticate\ndoctl auth init\n\n# Get your SSH key ID\ndoctl compute ssh-key list\n\n# Create droplet\ndoctl compute droplet create dutycall-backend \\\n  --image ubuntu-22-04-x64 \\\n  --size s-2vcpu-2gb \\\n  --region nyc1 \\\n  --ssh-keys YOUR_SSH_KEY_ID\n\n# Get droplet IP\ndoctl compute droplet list\n"})}),(0,s.jsx)(n.h3,{id:"step-2-install-lemp-stack",children:"Step 2: Install LEMP Stack"}),(0,s.jsx)(n.p,{children:"SSH into your droplet and run:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Update system\napt update && apt upgrade -y\n\n# Install Nginx\napt install -y nginx\n\n# Install PHP 8.3 and required extensions\napt install -y software-properties-common\nadd-apt-repository -y ppa:ondrej/php\napt update\napt install -y \\\n  php8.3 \\\n  php8.3-fpm \\\n  php8.3-cli \\\n  php8.3-mysql \\\n  php8.3-mbstring \\\n  php8.3-xml \\\n  php8.3-curl \\\n  php8.3-zip \\\n  php8.3-bcmath \\\n  php8.3-gd \\\n  php8.3-intl\n\n# Install MySQL\napt install -y mysql-server\n\n# Secure MySQL\nmysql_secure_installation\n\n# Install Composer\ncurl -sS https://getcomposer.org/installer | php\nmv composer.phar /usr/local/bin/composer\n\n# Install Certbot for SSL\napt install -y certbot python3-certbot-nginx\n\n# Install Git\napt install -y git\n"})}),(0,s.jsx)(n.h3,{id:"step-3-configure-mysql-database",children:"Step 3: Configure MySQL Database"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Login to MySQL\nmysql -u root -p\n\n# Create database and user\nCREATE DATABASE dutycall;\nCREATE USER 'dutycall'@'localhost' IDENTIFIED BY 'YOUR_SECURE_PASSWORD_HERE';\nGRANT ALL PRIVILEGES ON dutycall.* TO 'dutycall'@'localhost';\nFLUSH PRIVILEGES;\nEXIT;\n\n# Save credentials securely\ncat > /root/.dutycall-db-credentials << EOF\nDatabase: dutycall\nUsername: dutycall\nPassword: YOUR_SECURE_PASSWORD_HERE\nEOF\n\nchmod 600 /root/.dutycall-db-credentials\n"})}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Generate secure password:"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"openssl rand -base64 32\n"})}),(0,s.jsx)(n.h3,{id:"step-4-deploy-laravel-backend",children:"Step 4: Deploy Laravel Backend"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# Create application directory\nmkdir -p /var/www/dutycall\ncd /var/www/dutycall\n\n# Generate SSH deploy key for GitHub\nssh-keygen -t ed25519 -C "dutycall-production" -f ~/.ssh/dutycall_deploy_key -N ""\n\n# Display public key to add to GitHub\ncat ~/.ssh/dutycall_deploy_key.pub\n'})}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Add deploy key to GitHub:"})}),(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Go to GitHub repository \u2192 Settings \u2192 Deploy keys"}),"\n",(0,s.jsx)(n.li,{children:"Add new deploy key"}),"\n",(0,s.jsx)(n.li,{children:"Paste public key content"}),"\n"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# Clone repository\nGIT_SSH_COMMAND="ssh -i ~/.ssh/dutycall_deploy_key" git clone git@github.com:YOUR_ORG/dutycall.git backend\n\ncd backend\n\n# Install dependencies\ncomposer install --no-dev --optimize-autoloader\n\n# Configure environment\ncp .env.example .env\nnano .env  # Edit with production values\n'})}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Production .env:"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"APP_NAME=DutyCall\nAPP_ENV=production\nAPP_KEY=  # Will generate in next step\nAPP_DEBUG=false  # CRITICAL: Must be false\nAPP_URL=https://api.dutycall.net\n\nDB_CONNECTION=mysql\nDB_HOST=127.0.0.1\nDB_PORT=3306\nDB_DATABASE=dutycall\nDB_USERNAME=dutycall\nDB_PASSWORD=YOUR_SECURE_PASSWORD\n\nFRONTEND_URL=https://dutycall.vercel.app\nSANCTUM_STATEFUL_DOMAINS=dutycall.vercel.app\nSESSION_DOMAIN=.vercel.app\n\nSESSION_DRIVER=database\nQUEUE_CONNECTION=database\n\n# Add Twilio, Sentry, etc. as needed\n"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Initialize application\nphp artisan key:generate\nphp artisan session:table\nphp artisan migrate --force\nphp artisan db:seed --class=RoleTestUsersSeeder --force\n\n# Set permissions (CRITICAL)\nchown -R www-data:www-data storage bootstrap/cache\nchmod -R 775 storage bootstrap/cache\n\n# Cache configuration\nphp artisan config:cache\nphp artisan route:cache\nphp artisan view:cache\n"})}),(0,s.jsx)(n.h3,{id:"step-5-configure-nginx",children:"Step 5: Configure Nginx"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# Create Nginx site configuration\ncat > /etc/nginx/sites-available/dutycall << \'EOF\'\nserver {\n    listen 80;\n    server_name api.dutycall.net;\n    return 301 https://$server_name$request_uri;\n}\n\nserver {\n    listen 443 ssl http2;\n    server_name api.dutycall.net;\n    root /var/www/dutycall/backend/public;\n    index index.php index.html;\n\n    ssl_certificate /etc/letsencrypt/live/api.dutycall.net/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/api.dutycall.net/privkey.pem;\n\n    add_header X-Frame-Options "SAMEORIGIN" always;\n    add_header X-Content-Type-Options "nosniff" always;\n    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;\n\n    location / {\n        try_files $uri $uri/ /index.php?$query_string;\n    }\n\n    location ~ \\.php$ {\n        fastcgi_pass unix:/var/run/php/php8.3-fpm.sock;\n        fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;\n        include fastcgi_params;\n        fastcgi_hide_header X-Powered-By;\n    }\n\n    location ~ /\\. {\n        deny all;\n    }\n\n    access_log /var/log/nginx/dutycall-access.log;\n    error_log /var/log/nginx/dutycall-error.log;\n}\nEOF\n\n# Enable site\nln -s /etc/nginx/sites-available/dutycall /etc/nginx/sites-enabled/\nrm -f /etc/nginx/sites-enabled/default\nnginx -t\nsystemctl restart nginx\n'})}),(0,s.jsx)(n.h3,{id:"step-6-configure-dns--ssl",children:"Step 6: Configure DNS & SSL"}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Add DNS A record:"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Type: A\nHost: api\nValue: YOUR_DROPLET_IP\n"})}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Install SSL certificate:"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"certbot --nginx -d api.dutycall.net\nsystemctl list-timers | grep certbot  # Verify auto-renewal\n"})}),(0,s.jsx)(n.h3,{id:"step-7-configure-firewall",children:"Step 7: Configure Firewall"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ufw allow OpenSSH\nufw allow 'Nginx Full'\nufw enable\nufw status\n"})}),(0,s.jsx)(n.h3,{id:"step-8-test-backend",children:"Step 8: Test Backend"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"curl https://api.dutycall.net/api/user\n# Should return 401 Unauthorized (means API is running)\n"})})]}),(0,s.jsxs)(a.A,{value:"ai",label:"\ud83e\udd16 AI Agent",children:[(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"DigitalOcean Setup Summary"}),":"]}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Infrastructure"}),":"]}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Ubuntu 22.04 LTS droplet ($12/month, 2GB RAM)"}),"\n",(0,s.jsx)(n.li,{children:"Nginx web server"}),"\n",(0,s.jsx)(n.li,{children:"PHP 8.3-FPM"}),"\n",(0,s.jsx)(n.li,{children:"MySQL 8.0+"}),"\n",(0,s.jsx)(n.li,{children:"Let's Encrypt SSL (auto-renew)"}),"\n",(0,s.jsx)(n.li,{children:"UFW firewall (ports 22, 80, 443)"}),"\n"]}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Deployment Flow"}),":"]}),(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Create droplet (doctl or web UI)"}),"\n",(0,s.jsx)(n.li,{children:"Install LEMP stack (Nginx, PHP, MySQL)"}),"\n",(0,s.jsx)(n.li,{children:"Configure MySQL database with secure password"}),"\n",(0,s.jsx)(n.li,{children:"Clone Laravel app from GitHub"}),"\n",(0,s.jsx)(n.li,{children:"Configure .env with production values"}),"\n",(0,s.jsx)(n.li,{children:"Run migrations, set permissions"}),"\n",(0,s.jsx)(n.li,{children:"Configure Nginx virtual host"}),"\n",(0,s.jsx)(n.li,{children:"Point DNS A record to droplet IP"}),"\n",(0,s.jsx)(n.li,{children:"Install SSL with Certbot"}),"\n",(0,s.jsx)(n.li,{children:"Enable firewall, test endpoints"}),"\n"]}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Key Files"}),":"]}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["App: ",(0,s.jsx)(n.code,{children:"/var/www/dutycall/backend"})]}),"\n",(0,s.jsxs)(n.li,{children:["Nginx config: ",(0,s.jsx)(n.code,{children:"/etc/nginx/sites-available/dutycall"})]}),"\n",(0,s.jsxs)(n.li,{children:["Logs: ",(0,s.jsx)(n.code,{children:"/var/log/nginx/dutycall-*.log"})]}),"\n",(0,s.jsxs)(n.li,{children:["DB credentials: ",(0,s.jsx)(n.code,{children:"/root/.dutycall-db-credentials"})]}),"\n"]}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Updates"}),":"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd /var/www/dutycall/backend\ngit pull origin main\ncomposer install --no-dev --optimize-autoloader\nphp artisan migrate --force\nphp artisan config:cache\nsystemctl restart php8.3-fpm\n"})})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"railway-deployment-alternative---not-recommended-for-production",children:"Railway Deployment (Alternative - Not Recommended for Production)"}),"\n",(0,s.jsxs)(t.A,{groupId:"developer-type",children:[(0,s.jsxs)(a.A,{value:"human",label:"\ud83d\udc68\u200d\ud83d\udcbb Human Developer",default:!0,children:[(0,s.jsx)(n.admonition,{title:"Use Railway at Your Own Risk",type:"warning",children:(0,s.jsx)(n.p,{children:"Railway has known reliability issues in production (see incident report above). Use for development/staging only, or ensure robust external monitoring is in place."})}),(0,s.jsx)(n.h3,{id:"step-1-install-railway-cli",children:"Step 1: Install Railway CLI"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm install -g @railway/cli\nrailway login\nrailway link  # Select your project\n"})}),(0,s.jsx)(n.h3,{id:"step-2-configure-environment-variables",children:"Step 2: Configure Environment Variables"}),(0,s.jsx)(n.p,{children:"Add via Railway dashboard or CLI:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"railway variables set APP_ENV=production\nrailway variables set APP_DEBUG=false\nrailway variables set APP_URL=https://YOUR_PROJECT.railway.app\nrailway variables set FRONTEND_URL=https://YOUR_FRONTEND.vercel.app\n# ... add all other variables from .env\n"})}),(0,s.jsx)(n.admonition,{title:"Document Variables Externally",type:"danger",children:(0,s.jsx)(n.p,{children:"Railway environment variables can disappear. Keep a backup copy in a secure location (1Password, encrypted file, etc.)."})}),(0,s.jsx)(n.h3,{id:"step-3-deploy",children:"Step 3: Deploy"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"git push origin main  # Auto-deploys\n# Or: railway up\n"})}),(0,s.jsx)(n.h3,{id:"step-4-run-migrations",children:"Step 4: Run Migrations"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"railway run php artisan migrate --force\nrailway run php artisan db:seed --class=RoleTestUsersSeeder --force\n"})})]}),(0,s.jsxs)(a.A,{value:"ai",label:"\ud83e\udd16 AI Agent",children:[(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Railway Deployment"})," (Use with caution):"]}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Setup"}),":"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm install -g @railway/cli\nrailway login\nrailway link\nrailway variables set KEY=VALUE\nrailway up\n"})}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Environment"}),":"]}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Auto-detects Laravel via composer.json"}),"\n",(0,s.jsx)(n.li,{children:"PostgreSQL database (not MySQL)"}),"\n",(0,s.jsx)(n.li,{children:"Auto-deploys on push to main"}),"\n",(0,s.jsx)(n.li,{children:"Docker containerization"}),"\n"]}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Risks"}),":"]}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Environment variables can disappear"}),"\n",(0,s.jsx)(n.li,{children:"No automatic backups on free tier"}),"\n",(0,s.jsx)(n.li,{children:"Limited control over infrastructure"}),"\n"]}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Mandatory if using Railway"}),":"]}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"External monitoring (UptimeRobot)"}),"\n",(0,s.jsx)(n.li,{children:"External env var backup"}),"\n",(0,s.jsx)(n.li,{children:"Migration plan to DigitalOcean ready"}),"\n"]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"vercel-frontend-deployment",children:"Vercel Frontend Deployment"}),"\n",(0,s.jsxs)(t.A,{groupId:"developer-type",children:[(0,s.jsxs)(a.A,{value:"human",label:"\ud83d\udc68\u200d\ud83d\udcbb Human Developer",default:!0,children:[(0,s.jsx)(n.h3,{id:"step-1-install-vercel-cli",children:"Step 1: Install Vercel CLI"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm install -g vercel\n"})}),(0,s.jsx)(n.h3,{id:"step-2-link-project",children:"Step 2: Link Project"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd frontend/\nvercel link  # Select your project\n"})}),(0,s.jsx)(n.h3,{id:"step-3-configure-environment-variables",children:"Step 3: Configure Environment Variables"}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"CRITICAL:"})," Add to ALL THREE environments (production, preview, development)"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# Production\necho "https://api.dutycall.net" | vercel env add NEXT_PUBLIC_API_URL production\n\n# Preview (PR deployments)\necho "https://api.dutycall.net" | vercel env add NEXT_PUBLIC_API_URL preview\n\n# Development\necho "http://localhost:8090" | vercel env add NEXT_PUBLIC_API_URL development\n'})}),(0,s.jsx)(n.h3,{id:"step-4-deploy",children:"Step 4: Deploy"}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Option A: Git Integration (Automatic)"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"git checkout main\ngit merge develop\ngit push origin main\n"})}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Option B: Manual Deploy"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd frontend/\nvercel deploy --prod\n"})}),(0,s.jsx)(n.h3,{id:"step-5-verify-deployment",children:"Step 5: Verify Deployment"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"vercel ls --prod\n# Visit production URL\n"})})]}),(0,s.jsxs)(a.A,{value:"ai",label:"\ud83e\udd16 AI Agent",children:[(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Vercel Deployment"}),":"]}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Setup"}),":"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'npm install -g vercel\ncd frontend/\nvercel link\necho "VALUE" | vercel env add VAR_NAME production\nvercel deploy --prod\n'})}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Auto-Deploy"}),":"]}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Push to main \u2192 Production deploy"}),"\n",(0,s.jsx)(n.li,{children:"Push to other branch \u2192 Preview deploy"}),"\n",(0,s.jsx)(n.li,{children:"Pull request \u2192 Unique preview URL"}),"\n"]}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Environment Variables"}),":"]}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Must set for production, preview, AND development"}),"\n",(0,s.jsx)(n.li,{children:"Rebuild required after env var changes (build-time injection)"}),"\n"]}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Edge Network"}),": Deploys to 100+ global CDN locations"]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"cors-configuration-best-practices",children:"CORS Configuration Best Practices"}),"\n",(0,s.jsxs)(t.A,{groupId:"developer-type",children:[(0,s.jsxs)(a.A,{value:"human",label:"\ud83d\udc68\u200d\ud83d\udcbb Human Developer",default:!0,children:[(0,s.jsx)(n.h3,{id:"the-problem",children:"The Problem"}),(0,s.jsx)(n.p,{children:"Backend CORS configured for ONE specific URL breaks when Vercel creates new deployment URLs."}),(0,s.jsx)(n.h3,{id:"the-solution",children:"The Solution"}),(0,s.jsxs)(n.p,{children:["Use pattern matching in ",(0,s.jsx)(n.code,{children:"backend/config/cors.php"}),":"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"<?php\n\nreturn [\n    'paths' => ['api/*', 'sanctum/csrf-cookie', 'dashboard/*', 'auth/*', 'analytics/*'],\n    'allowed_methods' => ['*'],\n    'allowed_origins' => array_filter([\n        'http://localhost:3000',\n        'http://localhost:3001',\n        'http://localhost:3002',\n        env('FRONTEND_URL'),  // Primary production URL\n    ]),\n\n    // \u2705 CRITICAL: Allow all Vercel preview deployments\n    'allowed_origins_patterns' => ['#https://.*\\.vercel\\.app$#'],\n\n    'allowed_headers' => ['*'],\n    'exposed_headers' => [],\n    'max_age' => 0,\n    'supports_credentials' => true,\n];\n"})}),(0,s.jsx)(n.h3,{id:"after-updating-cors-config",children:"After Updating CORS Config"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# DigitalOcean\nssh root@YOUR_DROPLET_IP\ncd /var/www/dutycall/backend\nphp artisan config:clear\nphp artisan config:cache\n\n# Railway\nrailway run php artisan config:clear\nrailway run php artisan config:cache\n"})}),(0,s.jsx)(n.h3,{id:"test-cors",children:"Test CORS"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'curl -v -X OPTIONS https://api.dutycall.net/api/login \\\n  -H "Origin: https://frontend-abc123.vercel.app" \\\n  -H "Access-Control-Request-Method: POST" \\\n  -H "Access-Control-Request-Headers: content-type,authorization"\n\n# Should return:\n# access-control-allow-origin: https://frontend-abc123.vercel.app\n# access-control-allow-credentials: true\n'})})]}),(0,s.jsxs)(a.A,{value:"ai",label:"\ud83e\udd16 AI Agent",children:[(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"CORS Pattern Matching"}),":"]}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Problem"}),": Single URL whitelisting breaks on Vercel preview URLs"]}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solution"}),": Regex pattern matching"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"'allowed_origins_patterns' => ['#https://.*\\.vercel\\.app$#']\n"})}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Explanation"}),":"]}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"allowed_origins"}),": Specific URLs (localhost, production)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"allowed_origins_patterns"}),": Regex for dynamic URLs"]}),"\n",(0,s.jsx)(n.li,{children:"Prevents breakage on new Vercel deployments"}),"\n"]}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"After Config Change"}),":"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"php artisan config:clear && php artisan config:cache\n"})}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Test"}),": Use curl with OPTIONS request and various Origin headers"]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"monitoring--alerting-mandatory-for-production",children:"Monitoring & Alerting (MANDATORY FOR PRODUCTION)"}),"\n",(0,s.jsxs)(t.A,{groupId:"developer-type",children:[(0,s.jsxs)(a.A,{value:"human",label:"\ud83d\udc68\u200d\ud83d\udcbb Human Developer",default:!0,children:[(0,s.jsxs)(n.admonition,{title:"Why Monitoring is Critical",type:"danger",children:[(0,s.jsxs)(n.p,{children:["The October 19, 2025 incident happened because we had NO monitoring. Railway environment variable disappeared \u2192 CORS broke \u2192 Login failed \u2192 ",(0,s.jsx)(n.strong,{children:"No alerts sent"})," \u2192 6+ hour outage."]}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Monitoring is not optional. It is mandatory for production deployments."})})]}),(0,s.jsx)(n.h3,{id:"uptimerobot-setup-free",children:"UptimeRobot Setup (Free)"}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Create free account:"})," ",(0,s.jsx)(n.a,{href:"https://uptimerobot.com/",children:"https://uptimerobot.com/"})]}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Configure 3 monitors:"})}),(0,s.jsx)(n.h4,{id:"1-backend-api-health",children:"1. Backend API Health"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Type: HTTP(s)\nName: DutyCall Backend API\nURL: https://api.dutycall.net/api/user\nInterval: 5 minutes\nMethod: HEAD\nExpected Status: 401 (unauthenticated - means API is running)\nAlert: Your email\n"})}),(0,s.jsx)(n.h4,{id:"2-ssl-certificate-monitor",children:"2. SSL Certificate Monitor"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Type: HTTP(s)\nName: DutyCall SSL Certificate\nURL: https://api.dutycall.net\nInterval: 5 minutes\nSSL Monitoring: Enabled\nAlert when expires in: 30 days\nAlert: Your email\n"})}),(0,s.jsx)(n.h4,{id:"3-frontend-health",children:"3. Frontend Health"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Type: HTTP(s)\nName: DutyCall Frontend\nURL: https://dutycall.vercel.app\nInterval: 5 minutes\nMethod: HEAD\nExpected Status: 200\nAlert: Your email\n"})}),(0,s.jsx)(n.h3,{id:"sentry-error-tracking-recommended",children:"Sentry Error Tracking (Recommended)"}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Backend:"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'composer require sentry/sentry-laravel\nphp artisan vendor:publish --provider="Sentry\\Laravel\\ServiceProvider"\n'})}),(0,s.jsxs)(n.p,{children:["Add to ",(0,s.jsx)(n.code,{children:".env"}),":"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"SENTRY_LARAVEL_DSN=https://YOUR_DSN@sentry.io/PROJECT_ID\nSENTRY_ENVIRONMENT=production\nSENTRY_TRACES_SAMPLE_RATE=0.2\n"})}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Frontend:"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm install --save @sentry/nextjs\nnpx @sentry/wizard@latest -i nextjs\n"})}),(0,s.jsxs)(n.p,{children:["Add to ",(0,s.jsx)(n.code,{children:".env"}),":"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"NEXT_PUBLIC_SENTRY_DSN=https://YOUR_DSN@sentry.io/PROJECT_ID\nSENTRY_ENVIRONMENT=production\n"})})]}),(0,s.jsxs)(a.A,{value:"ai",label:"\ud83e\udd16 AI Agent",children:[(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Monitoring Stack"}),":"]}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"UptimeRobot"})," (Uptime monitoring):"]}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Backend API health (expects 401 Unauthorized)"}),"\n",(0,s.jsx)(n.li,{children:"SSL certificate expiration (30-day warning)"}),"\n",(0,s.jsx)(n.li,{children:"Frontend availability (expects 200 OK)"}),"\n",(0,s.jsx)(n.li,{children:"5-minute intervals"}),"\n",(0,s.jsx)(n.li,{children:"Email alerts"}),"\n"]}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Sentry"})," (Error tracking):"]}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Backend: Laravel integration"}),"\n",(0,s.jsx)(n.li,{children:"Frontend: Next.js integration"}),"\n",(0,s.jsx)(n.li,{children:"Real-time error alerts"}),"\n",(0,s.jsx)(n.li,{children:"Stack traces with context"}),"\n",(0,s.jsx)(n.li,{children:"Performance monitoring"}),"\n"]}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Setup Commands"}),":"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Backend\ncomposer require sentry/sentry-laravel\n\n# Frontend\nnpm install --save @sentry/nextjs\nnpx @sentry/wizard@latest -i nextjs\n"})}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Configuration"}),": Add ",(0,s.jsx)(n.code,{children:"SENTRY_*"})," variables to environment"]}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Why Mandatory"}),": October 19, 2025 incident caused 6+ hour outage due to lack of monitoring"]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"security-best-practices",children:"Security Best Practices"}),"\n",(0,s.jsxs)(t.A,{groupId:"developer-type",children:[(0,s.jsxs)(a.A,{value:"human",label:"\ud83d\udc68\u200d\ud83d\udcbb Human Developer",default:!0,children:[(0,s.jsx)(n.h3,{id:"security-checklist",children:"Security Checklist"}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Backend (Laravel):"})}),(0,s.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(n.code,{children:"APP_DEBUG=false"})," in production"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(n.code,{children:"APP_ENV=production"})]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Strong database password (20+ random characters)"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(n.code,{children:".env"})," file permissions: ",(0,s.jsx)(n.code,{children:"chmod 600 .env"})]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Storage permissions: ",(0,s.jsx)(n.code,{children:"chown -R www-data:www-data storage"})]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","SSL certificate installed and auto-renewing"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Firewall configured (only ports 22, 80, 443 open)"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","SSH key authentication (disable password auth)"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Regular security updates scheduled"]}),"\n"]}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Frontend (Next.js):"})}),(0,s.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","No secrets in client-side code"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Environment variables use ",(0,s.jsx)(n.code,{children:"NEXT_PUBLIC_"})," prefix only for public values"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Content Security Policy configured"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Rate limiting on API routes"]}),"\n"]}),(0,s.jsx)(n.h3,{id:"hardening-ssh-access",children:"Hardening SSH Access"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"nano /etc/ssh/sshd_config\n\n# Set these values:\nPasswordAuthentication no\nPermitRootLogin prohibit-password\nPubkeyAuthentication yes\n\nsystemctl restart sshd\n"})}),(0,s.jsx)(n.h3,{id:"automated-security-updates",children:"Automated Security Updates"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"apt install -y unattended-upgrades\ndpkg-reconfigure --priority=low unattended-upgrades\n"})})]}),(0,s.jsxs)(a.A,{value:"ai",label:"\ud83e\udd16 AI Agent",children:[(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Security Configuration"}),":"]}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Critical Settings"}),":"]}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"APP_DEBUG=false"})," (prevents info disclosure)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"APP_ENV=production"})," (disables dev helpers)"]}),"\n",(0,s.jsx)(n.li,{children:"Strong passwords (20+ chars, random)"}),"\n",(0,s.jsx)(n.li,{children:"SSH key auth only (no passwords)"}),"\n"]}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"File Permissions"}),":"]}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:".env"}),": 600 (read/write owner only)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"storage/"}),": www-data",":www-data"," 775"]}),"\n"]}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Network Security"}),":"]}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Firewall: Ports 22, 80, 443 only"}),"\n",(0,s.jsx)(n.li,{children:"SSL/HTTPS: Required (auto-provisioned)"}),"\n",(0,s.jsx)(n.li,{children:"SSH: Key-based auth, no root password login"}),"\n"]}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Updates"}),":"]}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Automated security updates (unattended-upgrades)"}),"\n",(0,s.jsx)(n.li,{children:"Regular dependency updates"}),"\n",(0,s.jsx)(n.li,{children:"Credential rotation (quarterly)"}),"\n"]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,s.jsxs)(t.A,{groupId:"developer-type",children:[(0,s.jsxs)(a.A,{value:"human",label:"\ud83d\udc68\u200d\ud83d\udcbb Human Developer",default:!0,children:[(0,s.jsx)(n.h3,{id:"storage-permission-errors",children:"Storage Permission Errors"}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Symptoms:"}),' 500 errors, "failed to open stream: Permission denied"']}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Diagnosis:"})," Web server (www-data) doesn't have write permissions to Laravel storage directories."]}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Solution:"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ssh root@YOUR_DROPLET_IP\ncd /var/www/dutycall/backend\nchown -R www-data:www-data storage bootstrap/cache\nchmod -R 775 storage bootstrap/cache\nphp artisan config:clear\n"})}),(0,s.jsx)(n.h3,{id:"cors-errors",children:"CORS Errors"}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Symptoms:"})," \"No 'Access-Control-Allow-Origin' header\" in browser console"]}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Diagnosis:"})}),(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Backend doesn't recognize the frontend's origin"}),"\n",(0,s.jsx)(n.li,{children:"CORS config doesn't include pattern matching"}),"\n",(0,s.jsx)(n.li,{children:"Config cache is stale"}),"\n"]}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Solution:"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# 1. Verify CORS config has pattern matching\ncat /var/www/dutycall/backend/config/cors.php | grep allowed_origins_patterns\n# Should show: 'allowed_origins_patterns' => ['#https://.*\\.vercel\\.app$#']\n\n# 2. Clear config cache\ncd /var/www/dutycall/backend\nphp artisan config:clear\nphp artisan config:cache\n\n# 3. Test CORS\ncurl -v -X OPTIONS https://api.dutycall.net/api/login \\\n  -H \"Origin: https://YOUR_FRONTEND.vercel.app\" \\\n  -H \"Access-Control-Request-Method: POST\"\n"})}),(0,s.jsx)(n.h3,{id:"database-connection-errors",children:"Database Connection Errors"}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Symptoms:"}),' "SQLSTATE[HY000] [2002] Connection refused"']}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Solution:"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Check MySQL is running\nsystemctl status mysql\n\n# Test connection\nmysql -u dutycall -p dutycall\n\n# Verify .env credentials\ncat /root/.dutycall-db-credentials\ncat /var/www/dutycall/backend/.env | grep DB_\n"})}),(0,s.jsx)(n.h3,{id:"frontend---old-deployment-cached",children:"Frontend - Old Deployment Cached"}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Symptoms:"})," Changes don't appear after deployment"]}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Solution:"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# 1. Hard refresh browser (Cmd+Shift+R or Ctrl+Shift+R)\n\n# 2. Verify deployment is recent\nvercel ls --prod | head -5\n\n# 3. Force new deployment\ngit commit --allow-empty -m "chore: force redeploy"\ngit push origin main\n'})}),(0,s.jsx)(n.h3,{id:"frontend---environment-variables-not-applied",children:"Frontend - Environment Variables Not Applied"}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Symptoms:"})," App calls wrong API URL (localhost, old URL)"]}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Solution:"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# 1. Verify env vars exist\nvercel env ls | grep NEXT_PUBLIC_API_URL\n# Should show entries for production, preview, AND development\n\n# 2. Trigger rebuild (env vars are baked in at build time!)\ngit commit --allow-empty -m "chore: rebuild with env vars"\ngit push origin main\n'})})]}),(0,s.jsxs)(a.A,{value:"ai",label:"\ud83e\udd16 AI Agent",children:[(0,s.jsx)(n.h3,{id:"quick-diagnostic-commands",children:"Quick Diagnostic Commands"}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Backend Health:"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'curl -I https://api.dutycall.net/api/user  # Expect: 401\nssh root@IP "cd /var/www/dutycall/backend && php artisan migrate:status"\nssh root@IP "tail -n 50 /var/www/dutycall/backend/storage/logs/laravel.log"\n'})}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Frontend Health:"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"curl -I https://dutycall.vercel.app  # Expect: 200\nvercel ls --prod | head -5\nvercel logs --since 1h\n"})}),(0,s.jsx)(n.h3,{id:"common-issues-quick-fix-matrix",children:"Common Issues Quick Fix Matrix"}),(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Issue"}),(0,s.jsx)(n.th,{children:"Quick Fix"}),(0,s.jsx)(n.th,{children:"Verification"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Storage permissions"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:'ssh root@IP "cd /var/www/dutycall/backend && chown -R www-data:www-data storage bootstrap/cache && chmod -R 775 storage bootstrap/cache"'})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:'ssh root@IP "ls -la /var/www/dutycall/backend/storage"'})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"CORS errors"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:'ssh root@IP "cd /var/www/dutycall/backend && php artisan config:clear && php artisan config:cache"'})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:'curl -v -X OPTIONS https://api.dutycall.net/api/login -H "Origin: https://test.vercel.app"'})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Database connection"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:'ssh root@IP "systemctl status mysql"'})," then ",(0,s.jsx)(n.code,{children:'ssh root@IP "cd /var/www/dutycall/backend && php artisan config:clear"'})]}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ssh root@IP \"mysql -u dutycall -p dutycall -e 'SELECT 1'\""})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Stale frontend"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:'git commit --allow-empty -m "chore: force redeploy" && git push origin main'})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"vercel ls --prod | head -3"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Missing env vars"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"vercel env ls"})," then ",(0,s.jsx)(n.code,{children:'echo "VALUE" | vercel env add VAR_NAME production'})," then redeploy"]}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"vercel logs | grep NEXT_PUBLIC"})})]})]})]}),(0,s.jsx)(n.h3,{id:"investigation-checklist",children:"Investigation Checklist"}),(0,s.jsx)(n.p,{children:"When user reports an issue, execute in order:"}),(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Gather evidence"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'ssh root@IP "tail -100 /var/www/dutycall/backend/storage/logs/laravel.log"\nssh root@IP "tail -100 /var/log/nginx/dutycall-error.log"\nvercel logs --since 1h\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Test connectivity"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"curl -v https://api.dutycall.net/api/user\ncurl -v https://dutycall.vercel.app\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Check recent changes"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'ssh root@IP "cd /var/www/dutycall/backend && git log --oneline -5"\nvercel ls | head -10\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Verify configuration"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ssh root@IP \"cd /var/www/dutycall/backend && grep -E '(APP_ENV|APP_DEBUG|DB_|FRONTEND_URL)' .env\"\nvercel env ls\n"})}),"\n"]}),"\n"]}),(0,s.jsx)(n.h3,{id:"emergency-rollback",children:"Emergency Rollback"}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Backend (DigitalOcean):"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'ssh root@IP "cd /var/www/dutycall/backend && git log --oneline -5"\n# Note last working commit\nssh root@IP "cd /var/www/dutycall/backend && git checkout COMMIT_HASH && composer install --no-dev && php artisan config:cache && systemctl restart php8.3-fpm"\n'})}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Frontend (Vercel):"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'vercel ls --prod | head -10\n# In Vercel dashboard: Go to deployment \u2192 "Promote to Production"\n# Or: vercel rollback\n'})}),(0,s.jsx)(n.h3,{id:"key-files-reference",children:"Key Files Reference"}),(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"File"}),(0,s.jsx)(n.th,{children:"Purpose"}),(0,s.jsx)(n.th,{children:"Location"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Backend logs"}),(0,s.jsx)(n.td,{children:"Error traces"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/var/www/dutycall/backend/storage/logs/laravel.log"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Nginx error log"}),(0,s.jsx)(n.td,{children:"Web server errors"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/var/log/nginx/dutycall-error.log"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Nginx access log"}),(0,s.jsx)(n.td,{children:"Request logs"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/var/log/nginx/dutycall-access.log"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Backend .env"}),(0,s.jsx)(n.td,{children:"Config"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/var/www/dutycall/backend/.env"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"CORS config"}),(0,s.jsx)(n.td,{children:"CORS settings"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/var/www/dutycall/backend/config/cors.php"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"DB credentials"}),(0,s.jsx)(n.td,{children:"DB password"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/root/.dutycall-db-credentials"})})]})]})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"additional-resources",children:"Additional Resources"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/developers/getting-started/local-setup",children:"Local Development Setup"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/developers/getting-started/environment-config",children:"Environment Configuration"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/monitoring",children:"Monitoring Systems Guide"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Railway Docs"}),": ",(0,s.jsx)(n.a,{href:"https://docs.railway.app",children:"https://docs.railway.app"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Vercel Docs"}),": ",(0,s.jsx)(n.a,{href:"https://vercel.com/docs",children:"https://vercel.com/docs"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"DigitalOcean Docs"}),": ",(0,s.jsx)(n.a,{href:"https://docs.digitalocean.com",children:"https://docs.digitalocean.com"})]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Questions?"})," Check the troubleshooting section or contact ",(0,s.jsx)(n.a,{href:"mailto:support@dutycall.net",children:"support@dutycall.net"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Ready to deploy?"})," Start with DigitalOcean Droplet setup for production! \ud83d\ude80"]})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>a});var l=r(6540);const s={},i=l.createContext(s);function t(e){const n=l.useContext(i);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),l.createElement(i.Provider,{value:n},e.children)}},9365:(e,n,r)=>{r.d(n,{A:()=>t});r(6540);var l=r(4164);const s={tabItem:"tabItem_Ymn6"};var i=r(4848);function t(e){var n=e.children,r=e.hidden,t=e.className;return(0,i.jsx)("div",{role:"tabpanel",className:(0,l.A)(s.tabItem,t),hidden:r,children:n})}}}]);